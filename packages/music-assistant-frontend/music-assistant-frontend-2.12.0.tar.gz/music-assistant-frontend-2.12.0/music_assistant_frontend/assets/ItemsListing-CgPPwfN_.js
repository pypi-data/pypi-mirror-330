import{g as we,p as je,h as We,aj as qe,B as k,H as Ze,I as Je,ak as Qe,N as xe,aS as et,aO as tt,Q as J,R as c,S as n,D as ne,a0 as f,az as E,a4 as oe,aX as ge,x as T,c as q,bJ as N,as as X,U as u,a9 as p,Z as g,V as at,bI as Ie,bB as se,ao as B,ab as v,am as j,aa as lt,a5 as F,an as P,W as R,aq as it,b8 as W,bK as ot,b9 as st,bL as Se,bC as Be,bF as _e,bM as re,bN as $e,aL as nt,aK as rt,a7 as ut,bg as mt,bt as dt,bu as z,X as ct,a2 as $,ar as pt,bx as ft,b as le,w as U,o as vt,P as pe,bO as yt,aZ as G,Y as ht,bo as bt,G as fe,$ as ve,br as ie,bE as kt,bq as ye}from"./index-Dh4eMWSh.js";import{M as Ae}from"./MediaItemThumb-qvSgbsEl.js";import{B as Ce,L as wt}from"./ListItem-DGh5edsx.js";import{V as Te}from"./VCheckbox-TXYh27Ri.js";import{a as Z}from"./VBtn-BhCi07GX.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as gt,P as It}from"./PanelviewItemCompact-DDbQeVBC.js";import{V as St}from"./VSpacer-ccBzHnAJ.js";import{C as Bt}from"./Container-DqrvAJ3b.js";import{T as _t}from"./Toolbar-BSZVzl7b.js";import{V as $t}from"./VTextField-D84TJHgc.js";import{a as At,V as Ct}from"./VInfiniteScroll-BlYvE-Ae.js";import{V as he,a as be}from"./VRow-BCb-VNQG.js";import{V as Tt}from"./VVirtualScroll-DHrwgeZC.js";import{V as ke}from"./VAlert-BswcvAid.js";const Fe=Symbol.for("vuetify:v-item-group"),Ft=je({...xe(),...Qe({selectedClass:"v-item--selected"}),...Je(),...Ze()},"VItemGroup"),Ve=we()({name:"VItemGroup",props:Ft(),emits:{"update:modelValue":A=>!0},setup(A,l){let{slots:b}=l;const{themeClasses:I}=We(A),{isSelected:i,select:w,next:C,prev:V,selected:a}=qe(A,Fe);return()=>k(A.tag,{class:["v-item-group",I.value,A.class],style:A.style},{default:()=>{var _;return[(_=b.default)==null?void 0:_.call(b,{isSelected:i,select:w,next:C,prev:V,selected:a.value})]}})}}),M=we()({name:"VItem",props:et(),emits:{"group:selected":A=>!0},setup(A,l){let{slots:b}=l;const{isSelected:I,select:i,toggle:w,selectedClass:C,value:V,disabled:a}=tt(A,Fe);return()=>{var _;return(_=b.default)==null?void 0:_.call(b,{isSelected:I.value,selectedClass:C.value,select:i,toggle:w,value:V.value,disabled:a.value})}}}),De=J({__name:"FavoriteButton",props:{item:{}},setup(A){const l=A;return(b,I)=>{var i;return n(),c(Ce,ne(l,{variant:"list",icon:(i=b.item)!=null&&i.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[I[0]||(I[0]=w=>f(oe).toggleFavorite(b.item)),I[1]||(I[1]=E(()=>{},["prevent"])),I[2]||(I[2]=E(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Vt={key:0,class:"media-thumb listitem-media-thumb"},Dt={key:1,class:"media-thumb listitem-media-thumb"},Ot={key:0},Lt={key:1},Pt={key:0},Mt={key:0,class:"line-clamp-1"},Et={key:1},Kt={key:0},Rt={key:1},Nt={key:2},Yt={key:3},Xt={key:4},zt={key:5},Gt={key:6},Ht={key:7},Ut={key:4},jt={key:5},Wt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},qt=J({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:l}){const{t:b}=ge(),I=T(!1),i=A,w=q(()=>{if(!("provider_mappings"in i.item))return"";for(const e of i.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[N.DSF,N.FLAC,N.AIFF,N.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),C=l,V=function(e){const h="clientX"in e?e.clientX:e.touches[0].clientX,S="clientY"in e?e.clientY:e.touches[0].clientY;re(i.item,h,S,i.parentItem)},a=function(e){i.showCheckboxes||$e(i.item,e.clientX,e.clientY,i.parentItem)},_=function(e){i.showCheckboxes||_e(i.item,e.clientX,e.clientY,i.parentItem)};return(e,h)=>(n(),c(wt,{link:"","show-menu-btn":e.showMenu,class:X({unavailable:!e.isAvailable}),onClick:E(a,["stop"]),onMenu:E(V,["stop"])},{prepend:u(()=>[e.showCheckboxes?(n(),g("div",Vt,[k(Te,{"model-value":e.isSelected,onClick:h[0]||(h[0]=E(()=>{},["stop"])),"onUpdate:modelValue":h[1]||(h[1]=S=>{S!=null&&C("select",e.item,S)})},null,8,["model-value"])])):(n(),g("div",Dt,[k(Ae,{size:"50",item:e.isAvailable?e.item:void 0,class:X({dimmed:I.value})},null,8,["item","class"])])),!e.showCheckboxes&&e.item.is_playable?(n(),c(Z,{key:2,class:X({hidden:!I.value}),icon:"mdi-play",color:"primary",fab:"",size:"small",style:{position:"absolute",left:"12px",bottom:"12px"},onClick:E(_,["stop"]),onMouseenter:h[2]||(h[2]=S=>I.value=!0),onMouseleave:h[3]||(h[3]=S=>I.value=!1)},null,8,["class"])):p("",!0)]),title:u(()=>[e.item.media_type==f(F).FOLDER?(n(),g("span",Ot,[R("span",null,v(f(Se)(e.item,f(b))),1)])):(n(),g("span",Lt,[B(v(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),g("span",Pt,"("+v(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),c(f(se),{key:2,location:"bottom"},{activator:u(({props:S})=>[f(Be)(e.item.metadata.explicit||!1)?(n(),c(P,ne({key:0},S,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:u(()=>[R("span",null,v(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:u(()=>{var S;return[e.item.media_type==f(F).TRACK&&"provider_mappings"in e.item?(n(),g("div",Mt,[k(Ve,null,{default:u(()=>["artists"in e.item?(n(),c(M,{key:0},{default:u(()=>[B(v(f(W)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),c(M,{key:1},{default:u(()=>[B(" • "+v(e.item.album.name),1)]),_:1})):p("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),c(M,{key:2},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"md:album"}),B(" "+v(e.item.disc_number),1)]),_:1})):p("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),c(M,{key:3},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+v(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),c(M,{key:4},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+v(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==f(F).ALBUM&&"year"in e.item?(n(),g("div",Et,[e.item.album_type!=f(ot).UNKNOWN?(n(),g("span",Kt,v(e.$t("album_type."+e.item.album_type))+" • ",1)):p("",!0),R("span",null,v(f(W)(e.item.artists)),1),e.item.year?(n(),g("span",Rt," • "+v(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),g("div",Nt,v(f(W)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),g("div",Yt,v(e.item.owner),1)):"authors"in e.item&&e.item.authors?(n(),g("div",Xt,v(e.item.authors.join(" / ")),1)):"publisher"in e.item&&e.item.publisher?(n(),g("div",zt,v(e.item.publisher),1)):"metadata"in e.item&&((S=e.item.metadata)!=null&&S.description)&&[f(F).RADIO,f(F).PLAYLIST,f(F).FOLDER].includes(e.item.media_type)?(n(),g("div",Gt,v(f(st)(e.item.metadata.description,150)),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),g("div",Ht,v(e.$t(e.item.media_type)),1)):p("",!0)]}),append:u(()=>[w.value?(n(),c(at,{key:0,src:f(Ie),width:"30",class:X(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:u(()=>[k(f(se),{activator:"parent",location:"bottom"},{default:u(()=>[B(v(w.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),f(j)("bp2")&&e.showProvider?(n(),c(lt,{key:1,domain:e.item.media_type==f(F).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),"fully_played"in e.item&&e.item.fully_played?(n(),c(P,{key:2,title:e.$t("item_fully_played")},{default:u(()=>h[4]||(h[4]=[B("mdi-check")])),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(n(),c(P,{key:3,title:e.$t("item_in_progress")},{default:u(()=>h[5]||(h[5]=[B("mdi-clock-fast")])),_:1},8,["title"])):p("",!0),f(j)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),g("div",Ut,[k(De,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&f(j)("bp0")?(n(),g("div",jt,[R("div",null,[R("span",Wt,v(f(it)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["show-menu-btn","class"]))}}),Zt=ue(qt,[["__scopeId","data-v-fde2a7b4"]]),Jt={key:0},Qt={key:1},xt={key:2},ea=["src"],ta={key:0},aa=J({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:l}){const b=A,I=q(()=>{for(const a of b.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[N.DSF,N.FLAC,N.AIFF,N.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),i=l,w=function(a){if(b.showCheckboxes)return;const _="clientX"in a?a.clientX:a.touches[0].clientX,e="clientY"in a?a.clientY:a.touches[0].clientY;re(b.item,_,e,b.parentItem)},C=function(a){if(b.showCheckboxes){i("select",b.item,!b.isSelected);return}$e(b.item,a.clientX,a.clientY,b.parentItem)},V=function(a){b.showCheckboxes||_e(b.item,a.clientX,a.clientY,b.parentItem)};return(a,_)=>{const e=nt("hold");return n(),c(gt,null,{default:u(({isHovering:h,props:S})=>[rt((n(),c(ut,ne(S,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:C,onContextmenu:E(w,["right","prevent"])}),{default:u(()=>[a.showCheckboxes?(n(),c(mt,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:u(()=>[k(Te,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),k(Ae,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),k(ct,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:u(()=>[k(dt,null,{default:u(()=>[a.item.media_type==f(F).FOLDER?(n(),g("span",Jt,[R("span",null,v(f(Se)(a.item,a.$t)),1)])):(n(),g("span",Qt,v(a.item.name),1)),"version"in a.item&&a.item.version?(n(),g("span",xt," - "+v(a.item.version),1)):p("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(n(),c(z,{key:0,class:"line-clamp-1"},{default:u(()=>[B(v(f(W)(a.item.artists,1)),1)]),_:1})):p("",!0),"authors"in a.item&&a.item.authors?(n(),c(z,{key:1,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(n(),c(z,{key:2,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(n(),c(z,{key:3,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.owner),1)]),_:1})):a.showMediaType?(n(),c(z,{key:4,class:"line-clamp-1"},{default:u(()=>[B(v(a.$t(a.item.media_type)),1)]),_:1})):(n(),c(z,{key:5,class:"line-clamp-1"}))]),_:1}),(h||f($).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(n(),c(Z,{key:1,icon:"mdi-play",color:"primary",fab:"",style:pt(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:E(V,["stop"])},null,8,["style"])):p("",!0),a.showActions?(n(),c(ft,{key:2,class:"panel-item-actions"},{default:u(()=>[k(Ve,{style:{padding:"0"}},{default:u(()=>[f(Be)(a.item.metadata.explicit||!1)?(n(),c(M,{key:0},{default:u(()=>[k(P,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),I.value?(n(),c(M,{key:1},{default:u(()=>[k(P,{class:X(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:u(()=>[R("img",{src:f(Ie),width:"30"},null,8,ea),k(se,{activator:"parent",location:"bottom"},{default:u(()=>[B(v(I.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),"track_number"in a.item&&a.item.track_number?(n(),c(M,{key:2},{default:u(()=>[k(P,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(n(),g("span",ta,v(a.item.disc_number)+"/",1)):p("",!0),B(v(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(n(),c(M,{key:3},{default:u(()=>[k(P,{size:"small",icon:"mdi-music-circle-outline"}),B(" "+v(a.item.position),1)]),_:1})):p("",!0),f(j)("bp3")?(n(),c(M,{key:4},{default:u(()=>[k(De,{item:a.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),k(St),h||a.$vuetify.display.mobile?(n(),c(Ce,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:E(w,["stop"])})):p("",!0)]),_:2},1024)):p("",!0)]),_:2},1040,["class"])),[[e,w]])]),_:1})}}}),la=ue(aa,[["__scopeId","data-v-9d8473a1"]]),ia={key:0},oa={key:2},sa=J({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(A){const l=A,b=kt(),{t:I}=ge(),i=T({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),w=T("list"),C=T(!1),V=T(!1),a=T([]),_=T([]),e=T(!1),h=T([]),S=T(!1),L=T(!1),Y=T(!0),K=T(!1),H=T(!1),Q=T(!1),Oe=function(){C.value?C.value=!1:(C.value=!0,pe(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},x=function(){Y.value=!Y.value;const t=`${l.path}.${l.itemtype}`;localStorage.setItem(`expand.${t}`,Y.value.toString())},ee=function(t){w.value=t;const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`viewMode.${o}`,t)},Le=function(){i.value.favoritesOnly=!i.value.favoritesOnly;const t=i.value.favoritesOnly?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`favoriteFilter.${o}`,t),O(void 0,void 0,!0)},Pe=function(){i.value.libraryOnly=!i.value.libraryOnly;const t=i.value.libraryOnly?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`libraryFilter.${o}`,t),O(!0,void 0,!0)},Me=function(){i.value.albumArtistsFilter=!i.value.albumArtistsFilter;const t=i.value.albumArtistsFilter?"true":"false",o=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumArtistsFilter.${o}`,t),O(void 0,void 0,!0)},te=function(t){return h.value.includes(t)},ae=function(t,o){if(o)h.value.includes(t)||h.value.push(t);else for(let s=0;s<h.value.length;s++)h.value[s]===t&&h.value.splice(s,1)},Ee=function(){L.value&&(h.value=[]),L.value=!L.value},Ke=function(){O(!0,!0)},Re=function(){i.value.search="",C.value=!1,O(void 0,void 0,!0)},Ne=function(t){t!==void 0&&(i.value.sortBy=t);const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`sortBy.${o}`,i.value.sortBy),O(void 0,void 0,!0)},Ye=function(t){var s,m;(s=i.value.albumType)!=null&&s.includes(t)?i.value.albumType=(m=i.value.albumType)==null?void 0:m.filter(y=>y!==t):(i.value.albumType=i.value.albumType||[],i.value.albumType.push(t));const o=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumType.${o}`,i.value.albumType.join(",")),O(void 0,void 0,!0)},Xe=function(){$.globalSearchTerm=i.value.search,l.itemtype=="artists"?$.globalSearchType=F.ARTIST:l.itemtype=="albums"?$.globalSearchType=F.ALBUM:l.itemtype=="tracks"?$.globalSearchType=F.TRACK:l.itemtype=="playlists"?$.globalSearchType=F.PLAYLIST:l.itemtype=="audiobooks"?$.globalSearchType=F.AUDIOBOOK:l.itemtype=="podcasts"?$.globalSearchType=F.PODCAST:l.itemtype=="radios"&&($.globalSearchType=F.RADIO),b.push({name:"search"})},ze=function({done:t}){if(K.value){t("empty");return}O(void 0,void 0,void 0,i.value.offset+l.limit).then(()=>{t("ok")})},me=q(()=>{var t=!1;return i.value.search&&i.value.search.length!==0&&(t=!0),t}),Ge=q(()=>{var o,s;if(l.allowCollapse===!0&&!Y.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:x,overflowAllowed:!1}];const t=[];return l.showSelectButton!==!1&&(L.value&&t.push({label:"tooltip.select_all",icon:"mdi-select-all",action:ce}),t.push({label:"tooltip.select_items",icon:L.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ee,active:L.value})),l.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Pe,active:i.value.libraryOnly}),l.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:i.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Le,active:i.value.favoritesOnly}),l.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:i.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Me,active:i.value.albumArtistsFilter}),l.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:e.value,subItems:["album","single","ep","compilation","unknown"].map(m=>{var y;return{label:`album_type.${m}`,selected:(y=i.value.albumType)==null?void 0:y.includes(m),action:()=>{Ye(m)}}})}),(l.showRefreshButton!==!1||S.value)&&t.push({label:S.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Ke,active:S.value,disabled:e.value}),(o=l.sortKeys)!=null&&o.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:l.sortKeys.length<=1||e.value,subItems:l.sortKeys.map(m=>({label:`sort.${m}`,selected:i.value.sortBy==m,action:()=>{Ne(m)}}))}),l.showSearchButton!==!1&&t.push({label:me.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Oe,active:me.value,disabled:e.value}),t.push({label:"tooltip.toggle_view_mode",icon:w.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:w.value=="list",action:()=>{ee("list")}},{label:"view.panel",icon:"mdi-grid",selected:w.value=="panel",action:()=>{ee("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:w.value=="panel_compact",action:()=>{ee("panel_compact")}}]}),(s=l.extraMenuItems)!=null&&s.length&&t.push(...l.extraMenuItems),l.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:x}),t}),O=async function(t=!1,o=!1,s=!1,m=0){if(!e.value){if(e.value=!0,s&&l.loadPagedData!=null&&(t=!0),(t||o)&&(m=0,K.value&&(Q.value=!0),K.value=!1,H.value=!1,S.value=!1),i.value.offset=m,i.value.limit=l.limit,i.value.refresh=o,l.loadPagedData!=null){const y=await l.loadPagedData(i.value);i.value.offset?a.value.push(...y):a.value=y,Math.abs(y.length-l.limit)>10&&(K.value=!0)}else if(l.loadItems!=null){(!H.value||o)&&(_.value=await l.loadItems(i.value),H.value=!0);const y=Ue(_.value,i.value);i.value.offset?a.value.push(...y):a.value=y,K.value=y.length<l.limit}i.value.refresh=!1,e.value=!1,Q.value=!1}},He=async function(){const t=`${l.path}.${l.itemtype}`,o=localStorage.getItem(`viewMode.${t}`);o&&o!=="null"?w.value=o:l.itemtype=="artists"||l.itemtype=="albums"?w.value="panel":w.value="list";const s=localStorage.getItem(`sortBy.${t}`);if(s&&s!=="null"&&l.sortKeys.includes(s)?i.value.sortBy=s:i.value.sortBy=l.sortKeys[0],l.showFavoritesOnlyFilter!==!1){const m=localStorage.getItem(`favoriteFilter.${t}`);m&&m=="true"&&(i.value.favoritesOnly=!0)}if(l.showLibraryOnlyFilter!==!1){const m=localStorage.getItem(`libraryFilter.${t}`);m&&m=="true"&&(i.value.libraryOnly=!0)}if(l.showAlbumArtistsOnlyFilter!==!1){const m=localStorage.getItem(`albumArtistsFilter.${t}`);m&&(i.value.albumArtistsFilter=m=="true")}if(l.allowCollapse!==!1){const m=localStorage.getItem(`expand.${t}`);m&&(Y.value=m=="true")}if(l.showAlbumTypeFilter===!0){const m=localStorage.getItem(`albumType.${t}`);m&&(i.value.albumType=m.split(","))}if(l.restoreState){let m=`search.${t}`;l.parentItem&&(m+=l.parentItem.item_id);const y=localStorage.getItem(m);y&&y!=="null"&&(i.value.search=y)}},de=function(t){$.dialogActive||e.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),ce()):!V.value&&t.key=="Backspace"?i.value.search=i.value.search.slice(0,-1):!V.value&&t.key.length==1&&(i.value.search+=t.key,C.value=!0))};l.allowKeyHooks&&(document.addEventListener("keydown",de),le(()=>{document.removeEventListener("keydown",de)})),l.restoreState&&le(()=>{const t=l.path||l.itemtype,o=document.querySelector("#cont");$.prevState={path:t,scrollPos:(o==null?void 0:o.scrollTop)||0,pagedItems:a.value,allItems:_.value,allItemsReceived:K.value,initialDataReceived:H.value,params:i.value}}),U(()=>i.value.search,t=>{t&&(C.value=!0),O(void 0,void 0,!0);let o=`search.${l.path}.${l.itemtype}`;l.parentItem&&(o+=l.parentItem.item_id),localStorage.setItem(o,i.value.search)}),U(()=>l.path,t=>{e.value!=!0&&(a.value=[],_.value=[],O(!0))}),U(()=>l.parentItem,()=>{e.value!=!0&&(_.value=[],S.value=!0)},{deep:!0}),U(()=>l.limit,t=>{i.value.limit=t}),U(()=>l.updateAvailable,t=>{e.value||(S.value=t)},{immediate:!0}),vt(async()=>{var s;He();const t=l.path||l.itemtype;l.restoreState&&((s=$.prevState)==null?void 0:s.path)==t?(i.value=$.prevState.params,a.value=$.prevState.pagedItems,_.value=$.prevState.allItems,K.value=$.prevState.allItemsReceived,H.value=$.prevState.initialDataReceived,pe(()=>{const m=document.getElementById("cont");m&&yt(m,$.prevState.scrollPos,50)}),e.value=!1):O(!0);const o=oe.subscribe_multi([G.MEDIA_ITEM_UPDATED,G.MEDIA_ITEM_DELETED,G.MEDIA_ITEM_PLAYED],m=>{if(m.event==G.MEDIA_ITEM_DELETED)a.value=a.value.filter(y=>y.uri!=m.object_id);else if(m.event==G.MEDIA_ITEM_UPDATED){const y=a.value.findIndex(d=>d.uri==m.object_id);y>=0&&(a.value[y]=m.data)}else if(m.event==G.MEDIA_ITEM_PLAYED){const y=a.value.findIndex(d=>d.uri==m.object_id);y>=0&&("fully_played"in a.value[y]&&(a.value[y].fully_played=m.data.fully_played),"resume_position_ms"in a.value[y]&&(a.value[y].resume_position_ms=m.data.seconds_played*1e3))}});le(o)});const D=function(t,o=!1){return t?"label"in t&&t.label&&t.name?I(t.label,[t.name]):"label"in t&&t.label?I(t.label):o&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},Ue=function(t,o){var m,y;let s=[];if(o.search){const d=o.search.toLowerCase();for(const r of t)(r.name.toLowerCase().includes(d)||"artist"in r&&((m=r.artist)!=null&&m.name.toLowerCase().includes(d))||"album"in r&&((y=r.album)!=null&&y.name.toLowerCase().includes(d))||"artists"in r&&r.artists&&r.artists.length&&r.artists[0].name.toLowerCase().includes(d))&&s.push(r)}else s=[...t];return o.sortBy=="name"&&s.sort((d,r)=>D(d).localeCompare(D(r),void 0,{numeric:!0})),o.sortBy=="sort_name"&&s.sort((d,r)=>D(d,!0).localeCompare(D(r,!0),void 0,{numeric:!0})),o.sortBy=="name_desc"&&s.sort((d,r)=>D(r).localeCompare(D(d),void 0,{numeric:!0})),o.sortBy=="sort_name_desc"&&s.sort((d,r)=>D(r,!0).localeCompare(D(d,!0),void 0,{numeric:!0})),o.sortBy=="album"&&s.sort((d,r)=>D(d.album).localeCompare(D(r.album),void 0,{numeric:!0})),o.sortBy=="artist"&&s.sort((d,r)=>D(d.artists[0]).localeCompare(D(r.artists[0]))),o.sortBy=="track_number"&&(s.sort((d,r)=>(d.track_number||0)-(r.track_number||0)),s.sort((d,r)=>(d.disc_number||0)-(r.disc_number||0))),o.sortBy=="position"&&s.sort((d,r)=>(d.position||0)-(r.position||0)),o.sortBy=="position_desc"&&s.sort((d,r)=>(r.position||0)-(d.position||0)),o.sortBy=="year"&&s.sort((d,r)=>(d.year||0)-(r.year||0)),o.sortBy=="year_desc"&&s.sort((d,r)=>(r.year||0)-(d.year||0)),o.sortBy=="recent"&&s.sort((d,r)=>(r.timestamp_added||0)-(d.timestamp_added||0)),o.sortBy=="duration"&&s.sort((d,r)=>(d.duration||0)-(r.duration||0)),o.sortBy=="duration_desc"&&s.sort((d,r)=>(r.duration||0)-(d.duration||0)),o.sortBy=="provider"&&s.sort((d,r)=>d.provider.localeCompare(r.provider)),o.favoritesOnly&&(s=s.filter(d=>d.favorite)),o.albumType&&o.albumType.length>0&&(s=s.filter(d=>{var r;return(r=o.albumType)==null?void 0:r.includes(d.album_type)})),s.slice(o.offset,o.offset+o.limit)},ce=function(){h.value=a.value,L.value=!0};return(t,o)=>t.hideOnEmpty&&a.value.length==0?p("",!0):(n(),g("section",ia,[k(_t,{icon:t.icon,title:t.title,count:i.value.search?a.value.length:t.total||_.value.length,color:"transparent","menu-items":Ge.value,onTitleClicked:x},null,8,["icon","title","count","menu-items"]),k(ht),C.value&&Y.value?(n(),c($t,{key:0,id:"searchInput",modelValue:i.value.search,"onUpdate:modelValue":o[0]||(o[0]=s=>i.value.search=s),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:o[1]||(o[1]=s=>V.value=!0),onBlur:o[2]||(o[2]=s=>V.value=!1),"onClick:clear":Re},null,8,["modelValue","label"])):p("",!0),Y.value?(n(),c(Bt,{key:1,variant:w.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:u(()=>[e.value?(n(),c(bt,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):p("",!0),!Q.value&&!(a.value.length==0&&K.value)?(n(),c(At,{key:1,onLoad:ze,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:u(()=>[w.value=="panel"?(n(),c(he,{key:0},{default:u(()=>[(n(!0),g(fe,null,ve(a.value,s=>(n(),c(be,{key:s.uri,cols:"12",class:X(`col-${f(ye)(t.$vuetify.display.width)}`)},{default:u(()=>[k(la,{item:s,"is-selected":te(s),"show-checkboxes":L.value,"show-actions":["tracks","albums"].includes(t.itemtype),"is-available":f(ie)(s),"parent-item":t.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),w.value=="panel_compact"?(n(),c(he,{key:1},{default:u(()=>[(n(!0),g(fe,null,ve(a.value,s=>(n(),c(be,{key:s.uri,cols:"12",class:X(`col-${f(ye)(t.$vuetify.display.width)}`)},{default:u(()=>[k(It,{item:s,"is-selected":te(s),"show-checkboxes":L.value,"is-available":f(ie)(s),"parent-item":t.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),w.value=="list"?(n(),c(Tt,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:u(({item:s})=>[k(Zt,{item:s,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":s.is_playable,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":L.value,"is-selected":te(s),"is-available":f(ie)(s),"show-details":t.itemtype.includes("versions"),"parent-item":t.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","show-details","parent-item"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["mode","load-more-text"])):p("",!0),!e.value&&a.value.length==0?(n(),g("div",oa,[!e.value&&a.value.length==0&&(i.value.search||i.value.favoritesOnly)?(n(),c(ke,{key:0,title:t.$t("no_content_filter")},{default:u(()=>[i.value.search?(n(),c(Z,{key:0,style:{"margin-top":"15px"},onClick:Xe},{default:u(()=>[B(v(t.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!e.value&&a.value.length==0?(n(),c(ke,{key:1},{default:u(()=>[B(v(t.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),k(Ct,{"model-value":h.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:u(()=>[k(Z,{color:"primary",variant:"text",onClick:o[3]||(o[3]=s=>f(re)(h.value,s.clientX,s.clientY,t.parentItem))},{default:u(()=>[B(v(t.$t("actions")),1)]),_:1})]),default:u(()=>[R("span",null,v(t.$t("items_selected",[h.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]))}}),Ia=ue(sa,[["__scopeId","data-v-b77da241"]]);export{Ia as I};
